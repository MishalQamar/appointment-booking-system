// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Employee {
  id                String              @id @default(uuid()) @map("employee_id")
  name              String              @map("employee_name")
  profilePictureUrl String?             @map("profile_picture_url")
  createdAt         DateTime            @default(now()) @map("created_at")
  updatedAt         DateTime            @updatedAt @map("updated_at")
  employeeService   EmployeeService[]
  Schedule          Schedule[]
  ScheduleExculsion ScheduleExculsion[]
  Appointment       Appointment[]

  @@map("employees")
}

model Service {
  id              String            @id @default(uuid()) @map("service_id")
  title           String            @map("service_title")
  price           Int               @map("service_price")
  duration        Int               @map("service_duration")
  createdAt       DateTime          @default(now()) @map("created_at")
  updatedAt       DateTime          @updatedAt @map("updated_at")
  employeeService EmployeeService[]
  Appointment     Appointment[]

  @@map("services")
}

model EmployeeService {
  employeeId String   @map("employee_id")
  serviceId  String   @map("service_id")
  employee   Employee @relation(fields: [employeeId], references: [id])
  service    Service  @relation(fields: [serviceId], references: [id])

  @@id(name: "employee_service_id", fields: [employeeId, serviceId])
  @@map("employee_services")
}

model Schedule {
  id                String    @id @default(uuid()) @map("schedule_id")
  employeeId        String    @map("employee_id")
  employee          Employee  @relation(fields: [employeeId], references: [id], onDelete: Cascade)
  startDate         DateTime? @map("start_date")
  endDate           DateTime? @map("end_date")
  mondayStartsAt    String?   @map("monday_starts_at")
  mondayEndsAt      String?   @map("monday_ends_at")
  tuesdayStartsAt   String?   @map("tuesday_starts_at")
  tuesdayEndsAt     String?   @map("tuesday_ends_at")
  wednesdayStartsAt String?   @map("wednesday_starts_at")
  wednesdayEndsAt   String?   @map("wednesday_ends_at")
  thursdayStartsAt  String?   @map("thursday_starts_at")
  thursdayEndsAt    String?   @map("thursday_ends_at")
  fridayStartsAt    String?   @map("friday_starts_at")
  fridayEndsAt      String?   @map("friday_ends_at")
  saturdayStartsAt  String?   @map("saturday_starts_at")
  saturdayEndsAt    String?   @map("saturday_ends_at")
  sundayStartsAt    String?   @map("sunday_starts_at")
  sundayEndsAt      String?   @map("sunday_ends_at")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("schedules")
}

model ScheduleExculsion {
  id         String   @id @default(uuid()) @map("schedule_exclusion_id")
  employeeId String   @map("employee_id")
  employee   Employee @relation(fields: [employeeId], references: [id])
  startDate  DateTime @map("start_date")
  endDate    DateTime @map("end_date")
  createdAt  DateTime @default(now()) @map("created_at")
  updatedAt  DateTime @updatedAt @map("updated_at")

  @@map("schedule_exclusions")
}

model Appointment {
  id          String    @id @default(uuid()) @map("appointment_id")
  employeeId  String    @map("employee_id")
  employee    Employee  @relation(fields: [employeeId], references: [id])
  serviceId   String    @map("service_id")
  service     Service   @relation(fields: [serviceId], references: [id])
  startDate   DateTime  @map("start_date")
  endDate     DateTime  @map("end_date")
  cancelledAt DateTime? @map("cancelled_at")
  name        String?   @map("name")
  email       String?   @map("email")
  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @updatedAt @map("updated_at")

  @@map("appointments")
}
